import{c1 as Z,d as _,b5 as j,c2 as ee,b8 as te,r as I,c3 as oe,w as G,q as z,B as H,c as x,E as b,x as M,F as y,Y as se,al as ne,a5 as W,a1 as le,bR as ie,C as re,c4 as ae,ar as ue,c5 as ce,G as C,H as de,L as me,J as fe,a3 as J}from"./index-BZdmBmj0.js";import{S as pe}from"./index-DetSc4co.js";import{F as ye,a as ge}from"./FullscreenOutlined-nuUhcSBp.js";import{d as he}from"./debounce-YDXz6DON.js";var ve="Expected a function";function O(w,$,a){var p=!0,L=!0;if(typeof w!="function")throw new TypeError(ve);return Z(a)&&(p="leading"in a?!!a.leading:p,L="trailing"in a?!!a.trailing:L),he(w,$,{leading:p,maxWait:$,trailing:L})}const $e=_({__name:"index",props:j({...ee(),fullscreen:{type:Boolean,default:!1}},{open:{type:Boolean},openModifiers:{}}),emits:j(["update:open","update:fullscreen","ok","cancel"],["update:open"]),setup(w,{emit:$}){const a=w,p=$,L=re(),R=te(w,"open"),u=I(a.fullscreen),q=I(""),s={top:"n-resize",left:"w-resize",right:"e-resize",bottom:"s-resize",topLeft:"nw-resize",topright:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",auto:"auto"};let F=!1;const E=oe("modalWrap"),N=()=>{R.value=!1,p("cancel")},D=async()=>{var e;await J();const o=(e=E.value)==null?void 0:e.querySelector(".ant-modal");o&&o.getBoundingClientRect().left<1&&(o.style.left=`${(document.documentElement.clientWidth-o.offsetWidth)/2}px`)},A=async()=>{u.value=!1,D()},K=(o,e)=>{e.style.cursor="move",e.onmousedown=O(t=>{if(u.value)return;document.body.style.userSelect="none";const c=t.clientX-o.getBoundingClientRect().left,d=t.clientY-o.getBoundingClientRect().top,n=l=>{if(u.value)return;let i=l.clientX-c,m=l.clientY-d;const g=document.documentElement.clientWidth-o.offsetWidth,h=document.documentElement.clientHeight-o.offsetHeight;i<=0&&(i=0),m<=0&&(m=0),i>=g&&(i=g),m>=h&&(m=h),o.style.left=`${Math.max(i,0)}px`,o.style.top=`${Math.max(m,0)}px`},r=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r),document.body.style.userSelect="auto"};document.addEventListener("mousemove",n),document.addEventListener("mouseup",r)},20)},Q=async()=>{await J();const o=E.value,e=o.querySelector(".ant-modal-wrap"),t=o.querySelector(".ant-modal");if(e&&t){D();const c=t.querySelector(".ant-modal-header");c&&K(t,c),e.onmousemove=O(d=>{if(u.value)return;const n=d.clientX-t.offsetLeft,r=d.clientY-t.offsetTop,l=d.clientX-t.offsetWidth-t.offsetLeft,i=d.clientY-t.offsetHeight-t.offsetTop,m=n<=0&&n>-8,g=r<5&&r>-8,h=l>=0&&l<8,T=i>-5&&i<8;m&&r>5&&i<-5?e.style.cursor=s.left:g&&n>5&&l<-5?e.style.cursor=s.top:h&&r>5&&i<-5?e.style.cursor=s.right:T&&n>5&&l<-5?e.style.cursor=s.bottom:n>-8&&n<=5&&r<=5&&r>-8?e.style.cursor=s.topLeft:n>-8&&n<=5&&i<=5&&i>-8?e.style.cursor=s.bottomLeft:l<8&&l>=-5&&r<=5&&r>-8?e.style.cursor=s.topright:l<8&&l>=-5&&i<=5&&i>-8?e.style.cursor=s.bottomRight:e.style.cursor=s.auto},20),e.onmousedown=d=>{if(u.value)return;const{top:n,bottom:r,left:l,right:i}=t.getBoundingClientRect(),m=d.clientX-l,g=d.clientY-n,h=t.offsetWidth,T=t.offsetHeight,f=e.style.cursor,U=O(v=>{if(u.value)return;f!==s.auto&&(document.body.style.userSelect="none");const k=`${Math.max(0,v.clientX-m)}px`,S=`${Math.max(0,v.clientY-g)}px`,B=`${Math.min(i,h+l-v.clientX)}px`,P=`${Math.min(window.innerWidth-l,v.clientX-l)}px`,X=`${Math.min(r,T+n-v.clientY)}px`,Y=`${Math.min(window.innerHeight-n,v.clientY-n)}px`;f===s.left?(t.style.left=k,t.style.width=B):f===s.top?(t.style.top=S,t.style.height=X):f===s.right?t.style.width=P:f===s.bottom?t.style.height=Y:f===s.topLeft?(t.style.left=k,t.style.top=S,t.style.height=X,t.style.width=B):f===s.topright?(t.style.top=S,t.style.width=P,t.style.height=X):f===s.bottomLeft?(t.style.left=k,t.style.width=B,t.style.height=Y):f===s.bottomRight&&(t.style.width=P,t.style.height=Y),q.value=t.style.width},20),V=()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",V),document.body.style.userSelect="auto",e.style.cursor=s.auto};document.addEventListener("mousemove",U),document.addEventListener("mouseup",V)}}F=!0};return G(R,async o=>{(o&&Object.is(F,!1)||a.destroyOnClose)&&Q()}),G(()=>L.fullPath,N),(o,e)=>{const t=ae;return z(),H(ie,{to:o.getContainer||"body"},[x(t,null,{default:b(()=>[M("div",{ref:"modalWrap",class:le(["draggable-modal",{fullscreen:u.value}])},[x(y(ue),se(y(ce)(a,["open","onCancel","onOk","onUpdate:open"]),{open:R.value,"onUpdate:open":e[2]||(e[2]=c=>R.value=c),"mask-closable":!1,"get-container":()=>y(E),width:q.value||o.width,onOk:e[3]||(e[3]=c=>p("ok")),onCancel:e[4]||(e[4]=c=>p("cancel"))}),ne({title:b(()=>[W(o.$slots,"title",{},()=>[C(de(o.$attrs.title||"标题"),1)])]),closeIcon:b(()=>[W(o.$slots,"closeIcon",{},()=>[x(y(pe),{class:"ant-modal-operate",onClick:e[1]||(e[1]=me(()=>{},["stop"]))},{default:b(()=>[u.value?(z(),H(y(ge),{key:1,onClick:A})):(z(),H(y(ye),{key:0,onClick:e[0]||(e[0]=c=>u.value=!0)})),x(y(fe),{onClick:N})]),_:1})])]),default:b(()=>[W(o.$slots,"default",{},()=>[e[5]||(e[5]=C(" ① 窗口可以拖动；")),e[6]||(e[6]=M("br",null,null,-1)),e[7]||(e[7]=C(" ② 窗口可以通过八个方向改变大小；")),e[8]||(e[8]=M("br",null,null,-1)),e[9]||(e[9]=C(" ③ 窗口可以最小化、最大化、还原、关闭；")),e[10]||(e[10]=M("br",null,null,-1)),e[11]||(e[11]=C(" ④ 限制窗口最小宽度/高度。 "))])]),_:2},[o.$slots.footer?{name:"footer",fn:b(()=>[W(o.$slots,"footer")]),key:"0"}:void 0]),1040,["open","get-container","width"])],2)]),_:3})],8,["to"])}}});export{$e as _,O as t};
