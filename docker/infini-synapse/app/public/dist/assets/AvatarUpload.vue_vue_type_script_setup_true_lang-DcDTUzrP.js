import{f as m}from"./dateUtil-CAYLO485.js";import{c as o,aq as C,aB as k,bh as B,d as M,b9 as N,r as l,e as V,w as O,q as v,v as h,E as f,F as w,x as I,y as T,K as j,M as _,ar as q,as as E}from"./index-Bg7aZkAR.js";import{T as i}from"./index-DNRd9KsP.js";import{S as D}from"./index-DcsEvC8o.js";import{P as F}from"./PlusOutlined-ChaOMNXo.js";import{_ as G}from"./index-CwehvujJ.js";function J(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!k(t)}const g=t=>/^https?:\/\//.test(t)?t:B+t,X=[{title:"头像",width:80,dataIndex:"avatar",hideInSearch:!0,customRender:({record:t})=>o(C,{src:g(t.avatar)},null)},{title:"用户名",width:120,dataIndex:"username"},{title:"呢称",width:120,hideInSearch:!0,dataIndex:"nickname"},{title:"所在部门",dataIndex:"dept",hideInSearch:!0,width:180,customRender:({record:t})=>o(i,null,{default:()=>{var a;return[(a=t.dept)==null?void 0:a.name]}})},{title:"所属角色",dataIndex:"roleNames",hideInSearch:!0,width:220,customRender:({record:t})=>{let a;return o(D,null,J(a=t.roles.map(n=>o(i,{color:"success",key:n.id},{default:()=>[n.name]})))?a:{default:()=>[a]})}},{title:"邮箱",width:120,dataIndex:"email"},{title:"手机",width:120,dataIndex:"phone"},{title:"备注",width:120,dataIndex:"remark"},{title:"状态",dataIndex:"status",width:100,hideInSearch:!0,formItemProps:{component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},customRender:({record:t})=>{const a=~~t.status===1;return o(i,{color:a?"success":"red"},{default:()=>[a?"启用":"禁用"]})}},{title:"创建时间",dataIndex:"createdAt",width:120,hideInSearch:!0,customRender:({record:t})=>m(t.createdAt)},{title:"修改时间",dataIndex:"updatedAt",width:120,hideInSearch:!0,customRender:({record:t})=>m(t.createdAt)}],L={key:0},z=["src"],Z=M({name:"AvatarUpload",inheritAttrs:!1,__name:"AvatarUpload",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(t){const a=N(t,"value"),n=l([]),u=l(!1),c=l(""),d=l(""),p=V(()=>g(a.value)),x=O(a,e=>{e&&!n.value.length&&(n.value=[{uid:`vc-upload-${Date.now()}-1`,name:e.split("/").at(-1),status:"done",url:p.value}],x())}),b=e=>{const r=e.type==="image/jpeg"||e.type==="image/png";r||_.error("You can only upload JPG/PNG file!");const s=e.size/1024/1024<2;return s||_.error("Image must smaller than 2MB!"),r&&s},y=async e=>{const{filename:r}=await E.toolsUpload.uploadUpload({file:e});a.value=r},A=async e=>{await y(e.file)},S=({file:e})=>{e.status="done",n.value=[e]},U=e=>{a.value="",n.value=[]},P=()=>{u.value=!1,d.value=""},R=async e=>{!e.url&&!e.preview&&(e.preview=p.value),c.value=e.url||e.preview,u.value=!0,d.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)};return(e,r)=>{const s=q;return v(),h(j,null,[o(w(G),{"file-list":n.value,name:"avatar","list-type":"picture-card",class:"min-h-[110px]","custom-request":A,onBeforeUpload:b,onChange:S,onRemove:U,onPreview:R},{default:f(()=>[n.value.length<1?(v(),h("div",L,[o(w(F)),r[0]||(r[0]=I("div",{style:{"margin-top":"8px"}},"Upload",-1))])):T("",!0)]),_:1},8,["file-list"]),o(s,{open:u.value,title:d.value,footer:null,onCancel:P},{default:f(()=>[I("img",{alt:"example",style:{width:"100%"},src:c.value},null,8,z)]),_:1},8,["open","title"])],64)}}});export{Z as _,X as b};
