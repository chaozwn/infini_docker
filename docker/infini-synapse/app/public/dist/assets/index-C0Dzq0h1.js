import{f as b}from"./dateUtil-B5XOsNoS.js";import{T as g}from"./index-BE3Oq0fx.js";import{c as s,G as v,d as w,r as p,bi as C,w as T,o as S,h as O,q as U,B,E as N,F as R,as as h}from"./index-BZdmBmj0.js";import{u as A}from"./dynamic-table-BZdmoe58.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-CIQVhq5r.js";import{_ as D}from"./FullscreenOutlined-nuUhcSBp.js";import"./index-RqEoKWUI.js";import"./index-Bd8gCf15.js";import"./_baseUniq-DFG0VhlI.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./collapseMotion-CeVCODdD.js";import"./move-Yc2zikxn.js";import"./RightOutlined-DbfXqY8t.js";import"./index-SO7luV8-.js";import"./index-CFFIJWRV.js";import"./isMobile-BbN7I0i_.js";import"./useMergedState-DhbHfaR-.js";import"./DownOutlined-TPYklMQS.js";import"./CheckOutlined-BtSoJBna.js";import"./VerticalRightOutlined-BWb9A0vU.js";import"./cloneDeep-Bn8dDUVD.js";import"./index-m_q9eXrx.js";import"./index-DetSc4co.js";import"./useFlexGapSupport-Dlv4D1r_.js";import"./index-DUIwCk99.js";import"./_castArrayLikeObject-Cgp_WWiE.js";import"./index-D34c0bXJ.js";import"./LeftOutlined-NtHlcvXs.js";import"./zh_CN-CAyhejr6.js";import"./index-DosOCn2Z.js";import"./FileOutlined-C57NXHue.js";import"./debounce-YDXz6DON.js";import"./Text-wprbVIxn.js";import"./EnterOutlined-D277SDaT.js";import"./CopyOutlined-nP9OuyZW.js";import"./index-CRVRze-2.js";import"./useRefs-DPbZSX2L.js";import"./QuestionCircleOutlined-BwaDrrQv.js";import"./isNumber-CBHNsjxX.js";import"./index-DlPi_fof.js";import"./index-DvBry-qp.js";import"./index-C8dDVPEy.js";import"./pick-BVW8h3T0.js";const E=[{title:"会话编号",dataIndex:"tokenId",ellipsis:!0,hideInSearch:!0},{title:"用户名",dataIndex:"username",customRender:({record:t})=>s("div",null,[s("span",{class:"pr-[4px]"},[t.username]),t.isCurrent&&s(g,{color:"processing"},{default:()=>[v("我")]})])},{title:"部门名称",dataIndex:"deptName"},{title:"登录IP",dataIndex:"ip",width:140},{title:"登录地点",dataIndex:"address"},{title:"浏览器",dataIndex:"browser"},{title:"操作系统",dataIndex:"os"},{title:"登录时间",dataIndex:"time",width:180,customRender:({record:t})=>b(t.time)}],Ce=w({name:"SystemMonitorOnline",__name:"index",setup(t){let l=[];const r=p(!0),m=p([]),d=p(!1),c=C(),[f,I]=A({size:"small"}),k=[...E,{title:"操作",width:80,dataIndex:"ACTION",actions:({record:e})=>[{label:"下线",auth:"system:online:kick",disabled:e.disable,popConfirm:{title:"确定下线该用户吗?",onConfirm:()=>x(e)}}]}],x=async e=>{await h.systemOnline.onlineKick({tokenId:e.tokenId}),I.reload()},_=(...e)=>{[...e]},y=e=>{const i=Object.keys(e);if(!i.some(n=>!!e[n])){o();return}m.value=l.filter(n=>i.every(a=>!e[a]||n[a].includes(e[a])))},o=async()=>{d.value=!0,l=await h.systemOnline.onlineList().finally(()=>d.value=!1),m.value=l},u=()=>{r.value&&o()};return T(r,e=>{e&&o()}),S(()=>{o(),c.emitter.on("onlineUser",u)}),O(()=>{c.emitter.off("onlineUser",u)}),(e,i)=>{const n=D;return U(),B(R(f),{"row-key":"tokenId","header-title":"在线用户","title-tooltip":"这是真实操作，请不要随意将其他用户踢下线。","data-source":m.value,columns:k,loading:d.value,onChange:_,onSearch:y,onReload:o},{toolbar:N(()=>[s(n,{checked:r.value,"onUpdate:checked":i[0]||(i[0]=a=>r.value=a),"checked-children":"开启实时更新","un-checked-children":"关闭实时更新"},null,8,["checked"])]),_:1},8,["data-source","loading"])}}});export{Ce as default};
