import{f as b}from"./dateUtil-Cm5Bz-mS.js";import{T as g}from"./index-DyQKtTWc.js";import{c as s,G as v,d as w,r as p,bi as C,w as T,o as S,h as O,q as U,B,E as N,F as R,as as h}from"./index-DVLlR84N.js";import{u as A}from"./dynamic-table-BetSOWxk.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-H1pk5mfh.js";import{_ as D}from"./FullscreenOutlined-BNd8ScY2.js";import"./index-CrAqI7Xd.js";import"./index-56k7MGET.js";import"./_baseUniq-CpbnMyai.js";import"./_arrayIncludesWith-DbV0gfeD.js";import"./collapseMotion-uP8nNRKv.js";import"./move-Wqj1yDfi.js";import"./RightOutlined-BWgSgZwW.js";import"./index-BCBeN_3i.js";import"./index-1E6-mc4C.js";import"./isMobile-BbN7I0i_.js";import"./useMergedState-ChT1iZSY.js";import"./DownOutlined-D5YSDVOB.js";import"./CheckOutlined-Cu1pR8lj.js";import"./VerticalRightOutlined-DBNpJazw.js";import"./cloneDeep-fIowCLqR.js";import"./index-BIpAusSw.js";import"./index-DoCX2tQ5.js";import"./useFlexGapSupport-5sj4bXnl.js";import"./index-DL_taWTh.js";import"./_castArrayLikeObject-Dvxu3Wbr.js";import"./index-sZvJ5Vxz.js";import"./LeftOutlined-DnMntKnb.js";import"./zh_CN-CAyhejr6.js";import"./index-bI9Q3_sH.js";import"./FileOutlined-CffCF8Ce.js";import"./debounce-JcoRzmJH.js";import"./Text-WsumYN5_.js";import"./EnterOutlined-Dz2fZKNr.js";import"./CopyOutlined-D7uZR0vR.js";import"./index-exmculXG.js";import"./useRefs-H236_SLK.js";import"./QuestionCircleOutlined-Czahv6CH.js";import"./isNumber-DMlnLLPn.js";import"./index-BpQK5mvu.js";import"./index-CRgrtT8U.js";import"./index-DOxjvCKf.js";import"./pick-CI41lKnc.js";const E=[{title:"会话编号",dataIndex:"tokenId",ellipsis:!0,hideInSearch:!0},{title:"用户名",dataIndex:"username",customRender:({record:t})=>s("div",null,[s("span",{class:"pr-[4px]"},[t.username]),t.isCurrent&&s(g,{color:"processing"},{default:()=>[v("我")]})])},{title:"部门名称",dataIndex:"deptName"},{title:"登录IP",dataIndex:"ip",width:140},{title:"登录地点",dataIndex:"address"},{title:"浏览器",dataIndex:"browser"},{title:"操作系统",dataIndex:"os"},{title:"登录时间",dataIndex:"time",width:180,customRender:({record:t})=>b(t.time)}],Ce=w({name:"SystemMonitorOnline",__name:"index",setup(t){let l=[];const r=p(!0),m=p([]),d=p(!1),c=C(),[f,I]=A({size:"small"}),k=[...E,{title:"操作",width:80,dataIndex:"ACTION",actions:({record:e})=>[{label:"下线",auth:"system:online:kick",disabled:e.disable,popConfirm:{title:"确定下线该用户吗?",onConfirm:()=>x(e)}}]}],x=async e=>{await h.systemOnline.onlineKick({tokenId:e.tokenId}),I.reload()},_=(...e)=>{[...e]},y=e=>{const i=Object.keys(e);if(!i.some(n=>!!e[n])){o();return}m.value=l.filter(n=>i.every(a=>!e[a]||n[a].includes(e[a])))},o=async()=>{d.value=!0,l=await h.systemOnline.onlineList().finally(()=>d.value=!1),m.value=l},u=()=>{r.value&&o()};return T(r,e=>{e&&o()}),S(()=>{o(),c.emitter.on("onlineUser",u)}),O(()=>{c.emitter.off("onlineUser",u)}),(e,i)=>{const n=D;return U(),B(R(f),{"row-key":"tokenId","header-title":"在线用户","title-tooltip":"这是真实操作，请不要随意将其他用户踢下线。","data-source":m.value,columns:k,loading:d.value,onChange:_,onSearch:y,onReload:o},{toolbar:N(()=>[s(n,{checked:r.value,"onUpdate:checked":i[0]||(i[0]=a=>r.value=a),"checked-children":"开启实时更新","un-checked-children":"关闭实时更新"},null,8,["checked"])]),_:1},8,["data-source","loading"])}}});export{Ce as default};
